---
import ClimbIcon from "@/components/icons/Climb.astro";
import { generateLorem } from "@/lib/utils";
import Product from "./Products/Product.astro";
import data from "./Products/product.json" assert { type: "json" };
import type { ProductType } from "./Products/types";
import RandomImage from "./RandomImage.astro";
import Section from "@/layouts/Section.astro";

const rawProducts = data.products;

const products: ProductType[] = rawProducts.map((product) => {
  return {
    ...product,
    title: generateLorem(5),
    description: generateLorem(40),
  };
});

const imgSize = {
  width: 400,
  height: 500,
};
---

<Section
  extension="md"
  className="relative vertical center py-52 px-52 gap-28 [&>article]:w-full [&>article]:justify-center [&>article]:items-center [&>article]:gap-28"
>
  <style>
    .before-footer-fade {
      --color-start: #ffffff;
      background: linear-gradient(to bottom, var(--color-start) 0%, var(--color-start) 85%, #94c2e7 100%);
    }
  </style>
  <!-- OVERLAY -->
  <!-- <div class="absolute-align full before-footer-fade -z-10"></div> -->
  <!-- OVERLAY -->
  {
    products.map((product: ProductType, i: number) => {
      if (i === 0) {
        return (
          <>
            <div class="w-full vertical">
              <ClimbIcon />
              <h2 class="text-xl w-full text-left">Ce que l'on vous conseille</h2>
            </div>
            <article class="horizontal" data-is={i}>
              <RandomImage width={imgSize.width} height={imgSize.height} />
              <Product {...product} />
            </article>
          </>
        );
      }
      if (i % 2 !== 0) {
        // even
        return (
          <article class="horizontal-reverse" data-is={i}>
            <RandomImage width={imgSize.width} height={imgSize.height} />
            <Product {...product} />
          </article>
        );
      }
      return (
        <article class="horizontal" data-is={i}>
          <RandomImage width={imgSize.width} height={imgSize.height} />
          <Product {...product} />
        </article>
      );
    })
  }
</Section>
